<?xml version="1.0" encoding="UTF-8"?>
<document>
	<title>Searching values</title>

	You have two options.

	<section>
		<title>Value search</title>

		The <quote>search</quote> command lets you search for values
		with a combination of filters.

		You can pass <link ref="proctal:cli:type-options">type
		options</link> to specify what type of values you want to
		search for.

		The following filters allow you to compare against another
		value:

		<list>
			<item><quote>--eq</quote> matches values that equal to
			the given value.</item>

			<item><quote>--ne</quote> matches values that do not
			equal to the given value.</item>

			<item><quote>--gt</quote> matches values that are
			greater than the given value.</item>

			<item><quote>--gte</quote> matches values that are
			greater than or equal to the given value.</item>

			<item><quote>--lt</quote> matches values that are
			lesser than the given value.</item>

			<item><quote>--lte</quote> matches values that are
			lesser than or equal to the given value.</item>
		</list>

		You can pass options that restrict where to search in memory:

		<list>
			<item><quote>--read</quote> search readable
			memory</item>

			<item><quote>--write</quote> search writable
			memory.</item>

			<item><quote>--execute</quote> search executable
			memory.</item>
		</list>

		If you pass the <quote>--input</quote> option, the command will
		expect you to pass the output of a previous search result. That
		will allow you to specify filters that compare the old values
		with the current ones in memory.

		The following filters allow you to compare against the old value:

		<list>
			<item><quote>--inc</quote> matches values that were
			incremented by the given value.</item>

			<item><quote>--inc-up-to</quote> matches values that
			were incremented up to the given value.</item>

			<item><quote>--dec</quote> matches values that were
			decremented by the given value.</item>

			<item><quote>--dec-up-to</quote> matches values that
			were decremented up to the given value.</item>

			<item><quote>--changed</quote> matches values that have
			changed.</item>

			<item><quote>--unchanged</quote> matches values that
			have not changed.</item>

			<item><quote>--increased</quote> matches values that
			have increased.</item>

			<item><quote>--decreased</quote> matches values that
			have decreased.</item>
		</list>

		Here's how you would find all 32-bit integers greater than 0
		and less than or equal to 100 in readable and writable memory
		regions of a program whose PID is 12345.

		<code type="bash-prompt">
$ proctal search --pid=12345 --type=integer --integer-size=32 --read --write --gt=0 --lte=100
		</code>

		And here's how you would search for all the values that
		increased after a previous search.

		<code type="bash-prompt">
$ proctal search --pid=12345 --type=integer --integer-size=32 --read --write --gt=0 --lte=100 &gt; search-1
$ proctal search --pid=12345 --type=integer --integer-size=32 --increased --input &lt; search-1
		</code>

		You can pass the <quote>--freeze</quote> option to keep the
		program frozen while searching.
	</section>

	<section>
		<title>Pattern matching</title>

		The <quote>pattern</quote> command allows you to search for a
		sequence of bytes that match a given pattern.

		Here's how you would search for potential function calls in x86:

		<code type="bash-prompt">
$ proctal pattern --pid=12345 --program-code 'E8 ?? ?? ?? ??'
		</code>

		You can pass options that restrict where to search in memory:

		<list>
			<item><quote>--read</quote> search readable
			memory</item>

			<item><quote>--write</quote> search writable
			memory.</item>

			<item><quote>--execute</quote> search executable
			memory.</item>

			<item><quote>--program-code</quote> search in the
			program's code.</item>
		</list>

		These options can be used together.

		The <quote>--freeze</quote> option keeps the program frozen
		while the search is going.
	</section>
</document>
